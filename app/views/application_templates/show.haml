%h1 Job Application for #{@template.position.name_and_department}

= form_tag controller: :application_records, action: :create do
  = fields_for :responses do |r|
    - @template.questions.each do |question|
      .field
        - if question.explanation?
          = render_markdown question.prompt
        - elsif question.heading?
          %h3.heading= question.prompt
        -else
          = question.prompt
          - case question.data_type
          - when 'text', 'date'
            = r.text_field question.prompt, required: question.required?,
              class: ('datepicker' if question.date?), size: 50
          - when 'number'
            = r.number_field question.prompt, required: question.required?
          - when 'yes/no'
            Yes
            = r.radio_button question.prompt, 'yes', required: question.required?
            No
            = r.radio_button question.prompt, 'no', required: question.required?
  = hidden_field_tag :position_id, @template.position_id
  = submit_tag 'Submit application' unless @current_user.staff?
